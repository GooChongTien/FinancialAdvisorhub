# Add New Lead Form - Before & After

## Visual Comparison

### BEFORE (Individual Only)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ Add New Lead                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Name *                             â”‚
â”‚  [Enter full name____________]      â”‚
â”‚                                     â”‚
â”‚  Contact Number *                   â”‚
â”‚  [+65 1234 5678___________]        â”‚
â”‚                                     â”‚
â”‚  Email (Optional)                   â”‚
â”‚  [email@example.com_______]        â”‚
â”‚                                     â”‚
â”‚  Lead Source                        â”‚
â”‚  [Referral â–¼]                      â”‚
â”‚                                     â”‚
â”‚  [Save & Close]                     â”‚
â”‚  [ğŸ“… Save & Schedule Appointment]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AFTER (Individual + Entity Support)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ Add New Lead                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  Customer Type *                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Individual âœ“ â”‚ Entity (Company) â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€ When "Entity" is selected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                               â”‚   â”‚
â”‚  â”‚  Company Name *                               â”‚   â”‚
â”‚  â”‚  [Enter company name________________]         â”‚   â”‚
â”‚  â”‚                                               â”‚   â”‚
â”‚  â”‚  Business Registration No. *                  â”‚   â”‚
â”‚  â”‚  [e.g., 202300001A_______________]           â”‚   â”‚
â”‚  â”‚                                               â”‚   â”‚
â”‚  â”‚  Industry *                                   â”‚   â”‚
â”‚  â”‚  [e.g., Technology, Finance_____]            â”‚   â”‚
â”‚  â”‚                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚ Num of Employees â”‚ Annual Revenue   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚ [50_________]   â”‚ [5000000____]   â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                       â”‚
â”‚  Contact Person Name * (or "Name" for Individual)    â”‚
â”‚  [Enter contact person name_____________]             â”‚
â”‚                                                       â”‚
â”‚  Contact Number *                                     â”‚
â”‚  [+65 1234 5678______________________]               â”‚
â”‚                                                       â”‚
â”‚  Email (Optional)                                     â”‚
â”‚  [email@example.com_________________]                â”‚
â”‚                                                       â”‚
â”‚  Lead Source                                          â”‚
â”‚  [Referral â–¼]                                        â”‚
â”‚                                                       â”‚
â”‚  [Save & Close]                                       â”‚
â”‚  [ğŸ“… Save & Schedule Appointment]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Changes Summary

### 1. Customer Type Selector (NEW)
- **Position:** First field in the form
- **Default:** Individual
- **Options:** Individual | Entity (Company)
- **Behavior:** Dynamically shows/hides entity fields

### 2. Entity Fields Section (CONDITIONAL)
**Appears only when "Entity" is selected:**

| Field | Required | Validation | Example |
|-------|----------|------------|---------|
| Company Name | âœ“ | Min 3 chars | TechCorp Pte Ltd |
| Business Reg No. | - | 4-15 alphanumeric (if provided) | 202300001A |
| Industry | - | Any text | Technology |
| Num of Employees | - | Positive integer | 50 |
| Annual Revenue | - | Positive number | 5000000 |

**Note:** Only **Company Name**, **Contact Person Name**, and **Contact Number** are mandatory for entity leads.

### 3. Contextual Labels
- **"Name" field** â†’ **"Contact Person Name"** (when Entity)
- Placeholder updates based on customer type

### 4. Dialog Size
- Width: `sm:max-w-md` â†’ `sm:max-w-2xl` (wider for entity fields)
- Added scrolling for smaller screens

## Example Scenarios

### Scenario 1: Individual Lead (Existing Flow - Unchanged)
1. Open dialog â†’ "Individual" already selected
2. Fill: Name, Contact Number, Email
3. Select Lead Source
4. Save

**Data Submitted:**
```json
{
  "customer_type": "Individual",
  "name": "John Tan",
  "contact_number": "91234567",
  "email": "john@example.com",
  "lead_source": "Referral",
  "status": "Not Initiated",
  "last_contacted": "2025-11-23T14:30:00Z"
}
```

### Scenario 2: Entity Lead (New Flow)
1. Open dialog
2. Change Customer Type to "Entity (Company)"
3. Fill entity section:
   - Company Name: "TechCorp Pte Ltd"
   - Business Reg: "202300001A"
   - Industry: "Technology"
   - Employees: 50
   - Revenue: 5000000
4. Fill contact person:
   - Name: "Sarah Lee"
   - Contact: "98765432"
   - Email: "sarah@techcorp.com"
5. Select Lead Source
6. Save

**Data Submitted:**
```json
{
  "customer_type": "Entity",
  "company_name": "TechCorp Pte Ltd",
  "business_registration_no": "202300001A",
  "industry": "Technology",
  "num_employees": 50,
  "annual_revenue": 5000000,
  "name": "Sarah Lee",
  "contact_number": "98765432",
  "email": "sarah@techcorp.com",
  "lead_source": "Referral",
  "status": "Not Initiated",
  "last_contacted": "2025-11-23T14:30:00Z"
}
```

## Mira AI Integration

### Before
```
User: "Add new lead John at 91234567"
Mira: [Prefills] name="John", contact_number="91234567"
```

### After (Enhanced)
```
User: "Add new entity lead TechCorp, reg 202300001A, industry Tech, contact Sarah 91234567"
Mira: [Prefills]
  customer_type="Entity"
  company_name="TechCorp"
  business_registration_no="202300001A"
  industry="Tech"
  name="Sarah"
  contact_number="91234567"
```

## Validation Behavior

### Individual Lead Validation
| Field | Validation |
|-------|------------|
| Name | Required |
| Contact Number | Required, min 8 digits |
| Email | Optional, valid format if provided |

### Entity Lead Validation (Additional)
| Field | Validation |
|-------|------------|
| Company Name | Required, min 3 chars |
| Business Reg No. | Optional, 4-15 alphanumeric if provided |
| Industry | Optional |
| Contact Person Name | Required |
| Num of Employees | Optional, positive integer if provided |
| Annual Revenue | Optional, positive number if provided |

**Key Point:** Only 3 fields are mandatory for entity leads:
1. Company Name
2. Contact Person Name
3. Contact Number

## Error Messages

### Invalid Entity Lead Example
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Company Name *                       â”‚
â”‚  [AB________________________]         â”‚
â”‚  âš ï¸ Company name must be at least    â”‚
â”‚     3 characters                      â”‚
â”‚                                       â”‚
â”‚  Business Registration No. (Optional) â”‚
â”‚  [123_______________________]         â”‚
â”‚  âš ï¸ Invalid format (4-15              â”‚
â”‚     alphanumeric characters)          â”‚
â”‚                                       â”‚
â”‚  Contact Person Name *                â”‚
â”‚  [_________________________]          â”‚
â”‚  âš ï¸ Contact person name is required  â”‚
â”‚                                       â”‚
â”‚  Contact Number *                     â”‚
â”‚  [12345_____________________]         â”‚
â”‚  âš ï¸ Enter a valid contact number     â”‚
â”‚     with at least 8 digits            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Note:** Business registration number only shows error if provided in invalid format. Industry has no validation.

## Testing Checklist

- âœ… Individual lead creation (existing flow)
- âœ… Entity lead creation with all fields
- âœ… Customer type switching (fields show/hide)
- âœ… Validation for individual leads
- âœ… Validation for entity leads
- âœ… Required field errors display
- âœ… Format validation (reg no, email, phone)
- âœ… Numeric field validation (employees, revenue)
- âœ… Form reset on close
- âœ… Mira prefill for both types
- âœ… All existing tests pass (171/171)

## Deployment Notes

### Database Requirements
Ensure `leads` table has these columns:
- `customer_type` VARCHAR
- `company_name` VARCHAR
- `business_registration_no` VARCHAR
- `industry` VARCHAR
- `num_employees` INTEGER
- `annual_revenue` DECIMAL

### Backend API
Update lead creation endpoint to accept:
- All new entity fields
- `customer_type` enum/varchar

### Migration Impact
âœ… **No breaking changes** - Existing individual lead flow unchanged
